version: "3"

tasks:
  build-ebpf:
    desc: "Build the eBPF program"
    cmds:
      - cargo run

  install-ebpf:
    desc: "Install the eBPF program"
    cmds:
      - sudo go run . {{ "{{ .HOOK }}" }}
    dir: {{project-name}}-go

  fmt:
    desc: "format go code"
    cmds:
      - sudo go fmt main.go
    dir: {{project-name}}-go

  default:
    desc: "Build and install the eBPF program"
    cmds:
      - task: fmt
      - task: build-ebpf
      - task: install-ebpf
